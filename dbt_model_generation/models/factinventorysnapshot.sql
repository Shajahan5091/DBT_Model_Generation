{#
------------------------------------------------------------------------
MODEL NAME: FactInventorySnapshot
TARGET TABLE: BSL_FINAL.DWH_MA.FACTINVENTORYSNAPSHOT
SOURCE TABLES: BSL_STAGING.DWH_STAGING.INVENTORY
DESCRIPTION: Daily snapshot of inventory quantities for each product in each warehouse location.
PREREQUISITES: Source table BSL_STAGING.DWH_STAGING.INVENTORY must be available and populated
PARAMETER: None
AUTHOR: AI Generated by Shajahan - 2024-12-19
------------------------------------------------------------------------
#}

{{ config(materialized='view') }}

with source_inventory as (
    select 
        product_id,
        warehouse_id,
        quantity_on_hand
    from {{ source('dwh_staging', 'inventory') }}
),

final as (
    select
        current_date() as snapshot_date,
        product_id,
        warehouse_id,
        quantity_on_hand
    from source_inventory
)

select * from final